-- Write a PL/SQL block of code using parameterized Cursor, that will merge the data available 
-- in the newly created table N_RollCall with the data available in the table O_RollCall. If the 
-- data in the first table already exist in the second table then that data should be skipped. output:

create table n_rollcall (roll int, name varchar(10));
insert into n_rollcall values (2,'vishal'), (5,'pratik'), (6,'parth');

create table o_rollcall (roll int, name varchar(10));
insert into o_rollcall values (2,'vishal'), (4,'hettik'), (3,'kartik'), (1,'deepak'), (5,'pratik');

delimiter $
create procedure p3(in r1 int)
begin
declare r2 int;
declare exit_loop boolean;
declare c1 cursor for select roll from o_rollcall where roll>r1;
declare continue handler for not found set exit_loop=true;
open c1;
loop1:loop
fetch c1 into r2;
if not exists(select * from n_rollcall where roll=r2)
then
insert into n_rollcall select * from o_rollcall where roll=r2;
end if;
if exit_loop
then
close c1;
leave loop1;
end if;
end loop loop1;
end;
$

call p3(2);
select*from n_rollcall;